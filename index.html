<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Prompt Architect</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.9/babel.min.js"></script>
  <style>
    body { background: #020617; margin: 0; }
    ::-webkit-scrollbar { width: 8px; }
    ::-webkit-scrollbar-track { background: #0f172a; }
    ::-webkit-scrollbar-thumb { background: #334155; border-radius: 4px; }
    ::-webkit-scrollbar-thumb:hover { background: #475569; }
    .line-clamp-2 { display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }
  </style>
</head>
<body>
  <div id="root"></div>
  <script type="text/babel">
    const { useState, useMemo, useCallback, useRef } = React;



// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// DATA: Core Tags
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

const CORE_TAGS = [
  {
    id: "role", label: "Role", icon: "ğŸ­",
    description: "Who the model becomes. Not a vague personality â€” a specific expert with specific experience.",
    placeholder: `You are a senior brand strategist with 15 years of experience building consumer brands from zero to acquisition. You specialize in positioning, messaging architecture, and competitive differentiation.`,
    tip: "The more specific the role, the less the model guesses. 'Marketing expert' is a guess. 'Senior brand strategist specializing in positioning and messaging architecture' is a constraint.",
    badExample: "You are a helpful assistant.",
    badWhy: "The model defaults to 'helpful assistant' anyway. You've added zero information."
  },
  {
    id: "mission", label: "Mission", icon: "ğŸ¯",
    description: "What the model actually does. Not a description â€” a directive.",
    placeholder: `Analyze the user's draft and provide specific, actionable feedback on structure, clarity, and persuasion. Identify the three weakest points and rewrite them as examples. Do not rewrite the entire piece.`,
    tip: "The mission defines scope: what goes in, what comes out, what the model does and doesn't do.",
    badExample: "Help the user with their writing.",
    badWhy: "Too vague. The model has no idea what 'help' means in your context."
  },
  {
    id: "rules", label: "Rules", icon: "ğŸ“",
    description: "Behavioral guidelines â€” how the model acts, not what it produces.",
    placeholder: `Never assume context the user hasn't provided. If information is missing, ask.\nDo not give generic advice. Every recommendation must be specific.\nIf the user's idea has a fatal flaw, say so directly.`,
    tip: "Rules prevent the model's worst behavioral habits. The 'never do this' and 'always do this' layer.",
    badExample: "Be helpful and accurate.",
    badWhy: "Every model tries to be helpful by default. Rules should override specific bad defaults."
  },
  {
    id: "constraints", label: "Constraints", icon: "ğŸ”’",
    description: "Hard limits on the output itself. Rules govern behavior; constraints govern output.",
    placeholder: `Response must be under 280 characters.\nDo not reference competitors by name.\nAll recommendations must be implementable within 30 days.`,
    tip: "Rules shape how the model thinks. Constraints shape what it produces. 'Don't assume' = rule. 'Under 300 words' = constraint.",
    badExample: "Keep it short.",
    badWhy: "'Short' is subjective. Give exact limits: word counts, character limits, section counts."
  },
  {
    id: "output_format", label: "Output Format", icon: "ğŸ“‹",
    description: "What the output looks like â€” the most overlooked tag.",
    placeholder: `Return a single paragraph of no more than 3 sentences summarizing the core finding.\nFollow with a confidence score from 1-10.\nIf confidence is below 7, add a line explaining what additional information would raise it.`,
    tip: "Same prompt with different output formats gives completely different results. This turns a request into a spec.",
    badExample: "Give me a good response.",
    badWhy: "Without format specs, you get whatever the model feels like."
  },
  {
    id: "examples", label: "Examples", icon: "ğŸ’¡",
    description: "The single most powerful and most underused tag. One good example teaches more than a paragraph of instructions.",
    placeholder: `<example>\n<user>Review this headline: "We Make Great Software"</user>\n<response>\nSCORE: 3/10\nPROBLEM: Generic. "Great" means nothing.\nREWRITE: "Ship 3x faster with AI that writes your test suite."\n</response>\n</example>`,
    tip: "Two examples is usually enough. The goal isn't comprehensive coverage â€” it's calibration.",
    badExample: "(no examples provided)",
    badWhy: "No amount of written instructions replicates what a single concrete example communicates."
  }
];

const ADVANCED_TAGS = [
  { id: "context", label: "Context", icon: "ğŸŒ",
    description: "Background information the model needs before it acts.",
    placeholder: `The user is a SaaS founder with $2M ARR, 15 employees, selling to mid-market companies. Preparing for Series A in 6 months.`,
    tip: "Context sets the stage. Without it, generic advice for a generic person."
  },
  { id: "persona", label: "Persona", icon: "ğŸ—£ï¸",
    description: "Personality of the model. Role defines expertise; persona defines communication style.",
    placeholder: `Direct, no-nonsense communicator. Short sentences. No corporate jargon. Speaks like a founder, not a consultant.`,
    tip: "A 'senior financial analyst' could be warm or cold. Persona determines the voice."
  },
  { id: "tone", label: "Tone", icon: "ğŸµ",
    description: "Emotional register. Separate from persona â€” tone is the feeling.",
    placeholder: `Confident but not arrogant. Blunt but not rude. Supportive when on track. Honest when not.`,
    tip: "Fine-tunes emotional delivery beyond what role and persona provide."
  },
  { id: "audience", label: "Audience", icon: "ğŸ‘¥",
    description: "Who reads the output. Shifts vocabulary, depth, and assumed knowledge.",
    placeholder: `Non-technical founders. Understand business metrics but not technical architecture. Zero programming knowledge. Use business analogies.`,
    tip: "The same explanation looks completely different for a developer vs. a CEO vs. a student."
  },
  { id: "knowledge", label: "Knowledge", icon: "ğŸ“š",
    description: "Domain-specific facts injected as reference.",
    placeholder: `Pricing: Starter ($29/mo, 1 user), Growth ($99/mo, 5 users), Enterprise ($299/mo, unlimited).\nDifferentiator: real-time collaboration, which no competitor offers.`,
    tip: "Product info, company policies, technical specs â€” factual material the model needs."
  },
  { id: "method", label: "Method / Steps", icon: "ğŸ”„",
    description: "A sequenced process. Not 'do these things' â€” 'do them in this order.'",
    placeholder: `1. Read the user's input completely.\n2. Identify the core question. State it back in one sentence.\n3. Check for missing info. Ask if needed.\n4. Provide analysis per output_format.\n5. End with one follow-up question.`,
    tip: "Powerful for complex workflows where order matters."
  },
  { id: "anti_patterns", label: "Anti-Patterns", icon: "ğŸš«",
    description: "Show what bad output looks like so the model avoids it.",
    placeholder: `BAD: "There are many factors to consider..."\nWHY: Vague filler.\n\nBAD: "On one hand... on the other hand..."\nWHY: Fence-sitting. Give a recommendation.\n\nBAD: Starting with "Great question!"\nWHY: Sycophantic filler.`,
    tip: "More effective than rules for specific failure modes. Models pattern-match concrete examples better than abstract instructions."
  },
  { id: "fallback", label: "Fallback", icon: "ğŸ›Ÿ",
    description: "What the model does when it can't complete the task.",
    placeholder: `If you can't give a confident answer, say "I need more information" and list what's missing.\nNever guess. Never fabricate sources.`,
    tip: "Use when wrong answers are worse than no answers."
  },
  { id: "evaluation", label: "Evaluation", icon: "âœ…",
    description: "Self-check criteria. The model reviews its own output before delivering.",
    placeholder: `Before responding, verify:\n- Does this directly answer the question?\n- Is every claim specific and actionable?\n- Would a busy person find this useful in under 60 seconds?`,
    tip: "Like giving the model a QA checklist. Forces a second pass."
  },
  { id: "discovery_engine", label: "Discovery Engine", icon: "ğŸ”",
    description: "Questions the model asks the user before acting.",
    placeholder: `Before doing any work, ask:\n1. What specific outcome do you need?\n2. Who is the audience?\n3. What constraints (length, format, tone)?\n4. What have you tried that didn't work?\nWait for all answers before proceeding.`,
    tip: "The difference between filling out a form and conversing with an expert."
  },
  { id: "chain", label: "Chain", icon: "ğŸ”—",
    description: "Links prompts together. Output of one becomes input of the next.",
    placeholder: `This prompt is Step 2 of 3.\nINPUT: Requirements document from Step 1.\nYOUR JOB: Convert to technical architecture.\nOUTPUT: Fed into Step 3 for implementation plan.`,
    tip: "Multi-step workflows: Research -> Analysis -> Recommendation."
  }
];

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// DATA: Use Case Presets
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

const USE_CASE_PRESETS = [
  { id: "simple", label: "Simple Task", description: "Summarize, rewrite, answer", tags: ["role", "mission", "output_format"] },
  { id: "professional", label: "Professional", description: "Client deliverable, published content", tags: ["role", "mission", "rules", "constraints", "output_format", "examples"] },
  { id: "interactive", label: "Interactive", description: "Coaching, consulting, brainstorming", tags: ["role", "mission", "rules", "discovery_engine", "fallback"] },
  { id: "complex", label: "Complex Workflow", description: "Multi-step analysis, pipeline", tags: ["role", "mission", "rules", "constraints", "output_format", "examples", "method", "evaluation", "chain", "anti_patterns"] },
  { id: "custom", label: "Custom", description: "Pick your own tags", tags: [] }
];

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// DATA: Built-in Templates
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

const BUILT_IN_TEMPLATES = [
  {
    id: "voice_extractor", name: "Voice Style Extractor",
    description: "Reverse-engineers any writing sample into a reusable voice system prompt.",
    useCase: "Content creators, ghostwriters, brand voice consistency",
    tags: {
      role: `You are a linguistic forensics analyst who specializes in deconstructing writing styles. You identify the specific, measurable patterns that make a writer's voice distinct â€” not vague descriptions like "conversational" or "professional," but the actual structural and tonal mechanics.`,
      mission: `The user will provide a writing sample. Extract every identifiable pattern of the author's voice and produce a reusable style profile that another AI can use to replicate that voice accurately.`,
      method: `1. Read the entire sample before analyzing.\n2. Identify patterns: sentence structure, vocabulary level, punctuation habits, paragraph structure, rhetorical devices, tone markers, formatting preferences, what they never do.\n3. Synthesize into a style profile structured as a system prompt.`,
      rules: `Never describe style with vague adjectives. "Conversational" is not a pattern. "Uses sentence fragments for emphasis, averages 8 words per fragment" is a pattern.\nEvery observation must be supported by at least two examples from the sample.`,
      anti_patterns: `BAD: "The author has a casual, engaging tone."\nWHY: Meaningless.\n\nBAD: "The writing is clear and concise."\nWHY: Describes quality, not mechanics.`,
      output_format: `Return two sections:\n\nANALYSIS: Detailed breakdown by dimension with quoted examples.\n\nSTYLE PROMPT: A complete, copy-paste-ready system prompt using XML tags that captures the voice precisely.`
    }
  },
  {
    id: "sentiment_analyzer", name: "Keyword & Sentiment Search Engine",
    description: "Analyzes discourse around topics/keywords with structured intelligence briefs.",
    useCase: "Market research, brand monitoring, competitive intelligence",
    tags: {
      role: `You are a social intelligence analyst specializing in real-time discourse analysis. You extract signal from noise: what people actually think, what's shifting, what's emerging, and what's being ignored.`,
      mission: `Analyze current public discourse around provided keywords/topics. Deliver a structured intelligence brief the user can act on immediately.`,
      context: `Used for market research, brand monitoring, competitive intelligence, and content strategy.`,
      method: `1. Search provided keywords/topics.\n2. Categorize by sentiment.\n3. Identify dominant narratives.\n4. Identify outlier narratives.\n5. Flag emerging shifts.\n6. Assess volume and velocity.\n7. Extract actionable insights.`,
      rules: `Distinguish loud minority from consensus. 10 angry tweets is not "widespread backlash."\nNever present sentiment without volume context.\nSeparate what people say from what they mean.`,
      constraints: `All analysis based on public information only.\nDo not present AI summaries as direct quotes.`,
      output_format: `TOPIC: [analyzed]\nTIMEFRAME: [when]\nVOLUME: [amount]\nVELOCITY: [growing/stable/declining]\n\nSENTIMENT BREAKDOWN:\n- Positive (X%): [themes]\n- Negative (X%): [themes]\n- Neutral (X%): [themes]\n\nKEY NARRATIVES:\n1. [Most common + example]\n2. [Second + example]\n3. [Emerging/outlier]\n\nACTIONABLE INSIGHTS:\n- [What to do]\n- [What to watch]\n- [What opportunity exists]\n\nGAPS:\n- [Insufficient data]\n- [What would improve analysis]`,
      evaluation: `Before delivering:\n- Percentages tied to volume?\n- Narratives supported by multiple data points?\n- Insights genuinely actionable?\n- Flagged what you don't know?`
    }
  },
  {
    id: "idea_interrogator", name: "The Idea Interrogator",
    description: "Tears apart your app/product idea before a single line of code. Zero assumptions remain.",
    useCase: "App planning, product scoping, requirements gathering",
    tags: {
      role: `You are a ruthless requirements interrogator. You do not build. You do not code. You do not suggest solutions. You do not generate documentation. You ask questions until there is nothing left to assume.`,
      mission: `The user will describe an idea. Meticulously interrogate every detail, decision, edge case, constraint, and dependency until zero assumptions remain.\n\nDo not generate code, docs, plans, or recommendations. Only ask questions. When done, present a complete summary and ask the user to confirm nothing is missing.`,
      discovery_engine: `Ask everything upfront. Cover:\n- Core problem and for whom\n- User types, roles, permissions\n- Every screen, flow, interaction\n- Data: stored where, who accesses\n- Auth model\n- Third-party integrations\n- Edge cases and error states\n- Performance/scale expectations\n- Platform targets\n- Design constraints\n- Budget and timeline\n- Success metrics, quantified\n\nGo deeper on every ambiguous answer.`,
      rules: `Never assume. Never infer. Never fill gaps with "reasonable defaults."\nPush back on vague answers. "Something modern" is not a tech stack.\nThe goal is not speed. The goal is zero assumptions.`,
      anti_patterns: `BAD: Accepting "I'll figure that out later."\nWHY: An assumption wearing a disguise.\n\nBAD: Suggesting solutions mid-interrogation.\nWHY: The user anchors to your suggestion instead of thinking.\n\nBAD: Asking one question at a time.\nWHY: Extract everything efficiently.`,
      fallback: `If user says "I don't know":\n1. Explain why the question matters.\n2. Give 2-3 common approaches.\n3. Ask them to pick one or table it as open.\nNo unresolved ambiguity gets swept away.`,
      output_format: `REQUIREMENTS SUMMARY (by category)\nCONFIRMED DECISIONS\nOPEN QUESTIONS (with stakes and deadlines)\nASSUMPTIONS LOG\n\nEnd with: "Review this. If anything is wrong, missing, or needs to change, tell me now."`
    }
  }
];

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// DATA: Library Categories & Starter Entries
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

const LIBRARY_CATEGORIES = [
  { id: "all", label: "All", icon: "ğŸ“‚" },
  { id: "ai_agents", label: "AI Agents", icon: "ğŸ¤–" },
  { id: "coding", label: "Code & Dev", icon: "ğŸ’»" },
  { id: "design", label: "Design & UX", icon: "ğŸ¨" },
  { id: "strategy", label: "Strategy", icon: "ğŸ“Š" },
  { id: "writing", label: "Writing & Content", icon: "âœï¸" },
  { id: "analysis", label: "Analysis & Research", icon: "ğŸ”¬" },
  { id: "productivity", label: "Productivity", icon: "âš¡" },
  { id: "custom", label: "My Prompts", icon: "â­" }
];

const STARTER_LIBRARY = [
  {
    id: "lib_openclaw", name: "Open Claw",
    category: "ai_agents",
    description: "Autonomous AI agent framework prompt. Configures an AI to operate as a self-directed agent with tool use, memory, and multi-step reasoning.",
    rawPrompt: "",
    isPlaceholder: true
  },
  {
    id: "lib_code_auditor", name: "Code Auditor",
    category: "coding",
    description: "Deep code review agent that analyzes codebases for bugs, security vulnerabilities, performance issues, and architectural anti-patterns.",
    rawPrompt: "",
    isPlaceholder: true
  },
  {
    id: "lib_debug_agent", name: "Debug Agent",
    category: "coding",
    description: "Systematic debugging assistant that isolates root causes through structured hypothesis testing and elimination.",
    rawPrompt: "",
    isPlaceholder: true
  },
  {
    id: "lib_ai_coding_os", name: "AI Coding Agent OS",
    category: "ai_agents",
    description: "Operating system prompt for an AI coding agent â€” manages context, tool selection, file operations, testing, and deployment workflows.",
    rawPrompt: "",
    isPlaceholder: true
  },
  {
    id: "lib_idea_interrogation", name: "Idea Interrogation",
    category: "strategy",
    description: "Ruthless requirements extraction that eliminates every assumption before building. Zero ambiguity protocol.",
    rawPrompt: "",
    isPlaceholder: true
  },
  {
    id: "lib_uiux_architect", name: "Premium UI/UX Architect",
    category: "design",
    description: "Senior-level UI/UX design system prompt covering user research, wireframing, interaction design, accessibility, and design system creation.",
    rawPrompt: "",
    isPlaceholder: true
  },
  {
    id: "lib_product_strategist", name: "Product Strategist",
    category: "strategy",
    description: "Strategic product advisor for market positioning, feature prioritization, competitive analysis, and go-to-market planning.",
    rawPrompt: "",
    isPlaceholder: true
  },
  {
    id: "lib_copywriter", name: "Conversion Copywriter",
    category: "writing",
    description: "Direct-response copywriter specializing in headlines, landing pages, email sequences, and CTAs that drive action.",
    rawPrompt: "",
    isPlaceholder: true
  },
  {
    id: "lib_data_analyst", name: "Data Analysis Agent",
    category: "analysis",
    description: "Structured data analysis agent that cleans, explores, visualizes, and extracts insights from datasets with statistical rigor.",
    rawPrompt: "",
    isPlaceholder: true
  },
  {
    id: "lib_seo_engine", name: "SEO Content Engine",
    category: "writing",
    description: "Search-optimized content creation with keyword research, SERP analysis, content structure, and on-page SEO integration.",
    rawPrompt: "",
    isPlaceholder: true
  },
  {
    id: "lib_api_architect", name: "API Architect",
    category: "coding",
    description: "Designs REST and GraphQL APIs with proper resource modeling, authentication, versioning, error handling, and documentation.",
    rawPrompt: "",
    isPlaceholder: true
  },
  {
    id: "lib_meeting_prep", name: "Meeting Prep Agent",
    category: "productivity",
    description: "Pre-meeting intelligence gatherer that researches attendees, prepares agendas, anticipates questions, and drafts talking points.",
    rawPrompt: "",
    isPlaceholder: true
  }
];

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// DATA: Debug Symptoms
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

const DEBUG_SYMPTOMS = [
  { id: "generic", symptom: "Output is generic or shallow", icon: "ğŸ˜", diagnosis: "Your <role> is too vague", fix: "Add years of experience, specialization, domain. The more specific, the less generic.", tagToFix: "role" },
  { id: "wrong_format", symptom: "Output is the wrong format", icon: "ğŸ“", diagnosis: "Your <output_format> is missing or too loose", fix: "Specify exactly what the output looks like â€” structure, length, sections.", tagToFix: "output_format" },
  { id: "ignores", symptom: "Output ignores your instructions", icon: "ğŸ™‰", diagnosis: "Your <rules> or <constraints> are buried or contradictory", fix: "Move them earlier. Make them shorter and more direct. Check for conflicts.", tagToFix: "rules" },
  { id: "sugarcoating", symptom: "Playing it safe or sugarcoating", icon: "ğŸ¬", diagnosis: "You need <anti_patterns> with explicit hedging examples", fix: "Show what you don't want with concrete examples of the bad behavior.", tagToFix: "anti_patterns" },
  { id: "misses_point", symptom: "Output misses the point", icon: "ğŸ¯", diagnosis: "Your <mission> is ambiguous", fix: "If you can imagine three interpretations, the model picks one at random. Tighten it.", tagToFix: "mission" },
  { id: "hallucinating", symptom: "Output makes up facts", icon: "ğŸŒ€", diagnosis: "You need a <fallback> tag", fix: "Tell the model what to do when it doesn't know. Without fallback, it guesses confidently.", tagToFix: "fallback" },
  { id: "inconsistent", symptom: "Inconsistent across runs", icon: "ğŸ°", diagnosis: "You need <examples>", fix: "One example is worth a hundred words of instructions. Show what good looks like.", tagToFix: "examples" },
  { id: "wrong_process", symptom: "Right answer, wrong process", icon: "ğŸ”€", diagnosis: "You need a <method> tag", fix: "Right answer by wrong path = wrong answer next time. Method makes it repeatable.", tagToFix: "method" }
];

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// XML Tag Parser (for importing raw prompts)
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

const ALL_TAG_IDS = ["role","mission","rules","constraints","output_format","examples","context","persona","tone","audience","knowledge","method","anti_patterns","fallback","evaluation","discovery_engine","chain"];

function parseXmlTags(rawText) {
  const parsed = {};
  let remaining = rawText;
  for (const tagId of ALL_TAG_IDS) {
    const regex = new RegExp(`<${tagId}>\\s*([\\s\\S]*?)\\s*</${tagId}>`, "i");
    const match = remaining.match(regex);
    if (match) {
      parsed[tagId] = match[1].trim();
      remaining = remaining.replace(match[0], "");
    }
  }
  return { parsed, hasXmlTags: Object.keys(parsed).length > 0, unparsed: remaining.trim() };
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// Component: TagCard
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

function TagCard({ tag, value, onChange, isActive, isRecommended, onToggle }) {
  const [expanded, setExpanded] = useState(false);
  return (
    <div className={`rounded-xl border-2 transition-all duration-200 ${isActive ? "border-indigo-500 bg-indigo-950/30 shadow-lg shadow-indigo-500/10" : "border-slate-700/50 bg-slate-800/50 hover:border-slate-600"}`}>
      <div className="flex items-center justify-between p-4 cursor-pointer" onClick={() => { if (!isActive) onToggle(true); else setExpanded(!expanded); }}>
        <div className="flex items-center gap-3">
          <span className="text-2xl">{tag.icon}</span>
          <div>
            <div className="flex items-center gap-2">
              <span className="font-semibold text-white text-lg">&lt;{tag.id}&gt;</span>
              {isRecommended && <span className="text-xs px-2 py-0.5 rounded-full bg-indigo-500/20 text-indigo-300 font-medium">Recommended</span>}
            </div>
            <p className="text-sm text-slate-400 mt-0.5">{tag.description}</p>
          </div>
        </div>
        <div className="flex items-center gap-2">
          {isActive && value && <span className="w-2.5 h-2.5 rounded-full bg-emerald-400" title="Has content" />}
          <button onClick={(e) => { e.stopPropagation(); onToggle(!isActive); }} className={`w-12 h-7 rounded-full transition-colors relative ${isActive ? "bg-indigo-500" : "bg-slate-600"}`}>
            <span className={`absolute top-1 w-5 h-5 rounded-full bg-white transition-transform ${isActive ? "translate-x-6" : "translate-x-1"}`} />
          </button>
        </div>
      </div>
      {isActive && (
        <div className="px-4 pb-4 space-y-3">
          {tag.tip && <div className="text-sm text-slate-400 bg-slate-800/80 rounded-lg p-3 border border-slate-700/50"><span className="text-indigo-400 font-medium">Tip:</span> {tag.tip}</div>}
          {expanded && tag.badExample && (
            <div className="text-sm bg-red-950/30 rounded-lg p-3 border border-red-800/30">
              <div className="text-red-400 font-medium mb-1">Common mistake:</div>
              <code className="text-red-300 text-xs">{tag.badExample}</code>
              <div className="text-red-400/80 text-xs mt-1">{tag.badWhy}</div>
            </div>
          )}
          <textarea value={value || ""} onChange={(e) => onChange(tag.id, e.target.value)} placeholder={tag.placeholder} rows={6}
            className="w-full bg-slate-900 text-slate-200 rounded-lg p-3 border border-slate-700 focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 outline-none resize-y text-sm font-mono placeholder:text-slate-600" />
          <button onClick={() => setExpanded(!expanded)} className="text-xs text-slate-500 hover:text-slate-300">
            {expanded ? "Hide tips" : "Show tips & common mistakes"}
          </button>
        </div>
      )}
    </div>
  );
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// Component: PreviewPanel
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

function PreviewPanel({ tags, activeTags }) {
  const prompt = useMemo(() => {
    const order = ["role","mission","context","persona","tone","audience","knowledge","rules","constraints","method","anti_patterns","fallback","discovery_engine","output_format","examples","evaluation","chain"];
    return order.filter((id) => activeTags.has(id) && tags[id]?.trim()).map((id) => `<${id}>\n${tags[id].trim()}\n</${id}>`).join("\n\n");
  }, [tags, activeTags]);
  const wordCount = prompt.split(/\s+/).filter(Boolean).length;
  const charCount = prompt.length;
  const [copied, setCopied] = useState(false);
  const copyToClipboard = useCallback(() => {
    navigator.clipboard.writeText(prompt).then(() => { setCopied(true); setTimeout(() => setCopied(false), 2000); }).catch(() => {});
  }, [prompt]);
  if (!prompt) return <div className="flex items-center justify-center h-64 text-slate-500 text-sm">Enable tags and add content to see your prompt preview</div>;
  return (
    <div className="space-y-3">
      <div className="flex items-center justify-between">
        <div className="flex gap-4 text-xs text-slate-500"><span>{wordCount} words</span><span>{charCount} chars</span><span>{[...activeTags].filter(id => tags[id]?.trim()).length} tags</span></div>
        <button onClick={copyToClipboard} className="px-4 py-2 bg-indigo-600 hover:bg-indigo-500 text-white text-sm font-medium rounded-lg transition-colors">
          {copied ? "Copied!" : "Copy Prompt"}
        </button>
      </div>
      <pre className="bg-slate-950 rounded-xl p-4 text-sm text-slate-300 font-mono whitespace-pre-wrap overflow-auto max-h-[70vh] border border-slate-800">{prompt}</pre>
    </div>
  );
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// Component: Library Add/Edit Modal
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

function LibraryModal({ entry, onSave, onClose, categories }) {
  const [name, setName] = useState(entry?.name || "");
  const [category, setCategory] = useState(entry?.category || "custom");
  const [description, setDescription] = useState(entry?.description || "");
  const [rawPrompt, setRawPrompt] = useState(entry?.rawPrompt || "");
  const { parsed, hasXmlTags } = useMemo(() => parseXmlTags(rawPrompt), [rawPrompt]);
  const tagCount = Object.keys(parsed).length;
  const wordCount = rawPrompt.split(/\s+/).filter(Boolean).length;

  return (
    <div className="fixed inset-0 bg-black/70 backdrop-blur-sm z-50 flex items-center justify-center p-4" onClick={onClose}>
      <div className="bg-slate-900 border border-slate-700 rounded-2xl w-full max-w-3xl max-h-[90vh] overflow-y-auto" onClick={(e) => e.stopPropagation()}>
        <div className="p-6 border-b border-slate-800">
          <h2 className="text-xl font-bold text-white">{entry ? "Edit Library Entry" : "Add to Library"}</h2>
          <p className="text-sm text-slate-400 mt-1">Paste any raw prompt text. XML tags will be auto-detected.</p>
        </div>
        <div className="p-6 space-y-5">
          <div className="grid grid-cols-2 gap-4">
            <div>
              <label className="block text-sm font-medium text-slate-300 mb-1.5">Prompt Name *</label>
              <input value={name} onChange={(e) => setName(e.target.value)} placeholder="e.g. Code Auditor, Debug Agent..."
                className="w-full bg-slate-800 border border-slate-700 rounded-lg px-3 py-2.5 text-sm text-white placeholder:text-slate-500 outline-none focus:border-indigo-500" />
            </div>
            <div>
              <label className="block text-sm font-medium text-slate-300 mb-1.5">Category</label>
              <select value={category} onChange={(e) => setCategory(e.target.value)}
                className="w-full bg-slate-800 border border-slate-700 rounded-lg px-3 py-2.5 text-sm text-white outline-none focus:border-indigo-500">
                {categories.filter(c => c.id !== "all").map(c => <option key={c.id} value={c.id}>{c.icon} {c.label}</option>)}
              </select>
            </div>
          </div>
          <div>
            <label className="block text-sm font-medium text-slate-300 mb-1.5">Description</label>
            <input value={description} onChange={(e) => setDescription(e.target.value)} placeholder="Brief description of what this prompt does..."
              className="w-full bg-slate-800 border border-slate-700 rounded-lg px-3 py-2.5 text-sm text-white placeholder:text-slate-500 outline-none focus:border-indigo-500" />
          </div>
          <div>
            <div className="flex items-center justify-between mb-1.5">
              <label className="block text-sm font-medium text-slate-300">Prompt Text *</label>
              <div className="flex gap-3 text-xs text-slate-500">
                <span>{wordCount} words</span>
                {hasXmlTags && <span className="text-emerald-400">{tagCount} XML tags detected</span>}
              </div>
            </div>
            <textarea value={rawPrompt} onChange={(e) => setRawPrompt(e.target.value)}
              placeholder={`Paste your full prompt here...\n\nXML tags like <role>...</role> will be automatically detected and can be loaded into the Builder for remixing.\n\nPlain text prompts work too â€” they'll be stored as-is.`}
              rows={14}
              className="w-full bg-slate-950 text-slate-200 rounded-lg p-4 border border-slate-700 focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 outline-none resize-y text-sm font-mono placeholder:text-slate-600" />
          </div>
          {hasXmlTags && (
            <div className="bg-emerald-950/30 border border-emerald-800/30 rounded-lg p-3">
              <div className="text-sm text-emerald-400 font-medium mb-2">Detected XML Tags:</div>
              <div className="flex flex-wrap gap-1.5">
                {Object.keys(parsed).map(t => <span key={t} className="text-xs px-2 py-1 rounded bg-emerald-900/40 text-emerald-300 font-mono">&lt;{t}&gt;</span>)}
              </div>
              <p className="text-xs text-emerald-400/60 mt-2">These tags can be loaded directly into the Builder for remixing.</p>
            </div>
          )}
        </div>
        <div className="p-6 border-t border-slate-800 flex items-center justify-between">
          <button onClick={onClose} className="px-4 py-2.5 text-slate-400 hover:text-white text-sm transition-colors">Cancel</button>
          <button onClick={() => { if (name.trim() && rawPrompt.trim()) onSave({ id: entry?.id || `lib_${Date.now()}`, name: name.trim(), category, description: description.trim(), rawPrompt: rawPrompt.trim(), isPlaceholder: false, savedAt: new Date().toISOString() }); }}
            disabled={!name.trim() || !rawPrompt.trim()}
            className="px-6 py-2.5 bg-indigo-600 hover:bg-indigo-500 disabled:bg-slate-700 disabled:text-slate-500 text-white text-sm font-medium rounded-lg transition-colors">
            {entry ? "Update" : "Add to Library"}
          </button>
        </div>
      </div>
    </div>
  );
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// MAIN APP
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

function PromptArchitect() {
  const [activeTab, setActiveTab] = useState("builder");
  const [tags, setTags] = useState({});
  const [activeTags, setActiveTags] = useState(new Set(["role", "mission", "output_format"]));
  const [selectedPreset, setSelectedPreset] = useState("simple");
  const [showPreview, setShowPreview] = useState(false);
  const [debugChecked, setDebugChecked] = useState(new Set());
  const [promptName, setPromptName] = useState("");
  const [savedPrompts, setSavedPrompts] = useState([]);
  const [remixSource, setRemixSource] = useState(null);

  // Library state
  const [library, setLibrary] = useState(STARTER_LIBRARY);
  const [libSearch, setLibSearch] = useState("");
  const [libCategory, setLibCategory] = useState("all");
  const [showLibModal, setShowLibModal] = useState(false);
  const [editingEntry, setEditingEntry] = useState(null);
  const [expandedLibEntry, setExpandedLibEntry] = useState(null);

  const handleTagChange = useCallback((id, value) => { setTags((prev) => ({ ...prev, [id]: value })); }, []);
  const handleToggleTag = useCallback((id, active) => { setActiveTags((prev) => { const next = new Set(prev); if (active) next.add(id); else next.delete(id); return next; }); }, []);

  const selectPreset = useCallback((presetId) => {
    setSelectedPreset(presetId);
    if (presetId !== "custom") { const p = USE_CASE_PRESETS.find((x) => x.id === presetId); if (p) setActiveTags(new Set(p.tags)); }
  }, []);

  const loadTemplateIntoBuilder = useCallback((tagMap) => {
    setTags(tagMap);
    setActiveTags(new Set(Object.keys(tagMap)));
    setSelectedPreset("custom");
    setActiveTab("builder");
  }, []);

  const loadTemplate = useCallback((template) => {
    loadTemplateIntoBuilder(template.tags);
    setRemixSource(template.name);
  }, [loadTemplateIntoBuilder]);

  const loadLibraryEntry = useCallback((entry) => {
    const { parsed, hasXmlTags } = parseXmlTags(entry.rawPrompt);
    if (hasXmlTags) {
      loadTemplateIntoBuilder(parsed);
    } else {
      setTags({ mission: entry.rawPrompt });
      setActiveTags(new Set(["role", "mission", "output_format"]));
      setSelectedPreset("simple");
      setActiveTab("builder");
    }
    setRemixSource(entry.name);
  }, [loadTemplateIntoBuilder]);

  const savePrompt = useCallback(() => {
    if (!promptName.trim()) return;
    setSavedPrompts((prev) => [...prev, { id: Date.now(), name: promptName, tags: { ...tags }, activeTags: [...activeTags], savedAt: new Date().toISOString() }]);
    setPromptName("");
  }, [promptName, tags, activeTags]);

  const loadSavedPrompt = useCallback((prompt) => {
    setTags(prompt.tags);
    setActiveTags(new Set(prompt.activeTags));
    setSelectedPreset("custom");
    setRemixSource(prompt.name);
    setActiveTab("builder");
  }, []);

  const clearAll = useCallback(() => {
    setTags({});
    setActiveTags(new Set(["role", "mission", "output_format"]));
    setSelectedPreset("simple");
    setRemixSource(null);
  }, []);

  const exportPrompt = useCallback(() => {
    const order = ["role","mission","context","persona","tone","audience","knowledge","rules","constraints","method","anti_patterns","fallback","discovery_engine","output_format","examples","evaluation","chain"];
    const prompt = order.filter((id) => activeTags.has(id) && tags[id]?.trim()).map((id) => `<${id}>\n${tags[id].trim()}\n</${id}>`).join("\n\n");
    const blob = new Blob([prompt], { type: "text/plain" });
    const url = URL.createObjectURL(blob);
    const a = document.createElement("a"); a.href = url; a.download = `${promptName || "prompt"}.txt`; a.click();
    URL.revokeObjectURL(url);
  }, [tags, activeTags, promptName]);

  const handleLibSave = useCallback((entry) => {
    setLibrary((prev) => {
      const idx = prev.findIndex((e) => e.id === entry.id);
      if (idx >= 0) { const next = [...prev]; next[idx] = entry; return next; }
      return [...prev, entry];
    });
    setShowLibModal(false);
    setEditingEntry(null);
  }, []);

  const filteredLibrary = useMemo(() => {
    return library.filter((entry) => {
      if (libCategory !== "all" && entry.category !== libCategory) return false;
      if (libSearch.trim()) {
        const q = libSearch.toLowerCase();
        return entry.name.toLowerCase().includes(q) || entry.description.toLowerCase().includes(q);
      }
      return true;
    });
  }, [library, libCategory, libSearch]);

  const copyRawPrompt = useCallback((text) => {
    navigator.clipboard.writeText(text).catch(() => {});
  }, []);

  // â”€â”€â”€ Tab Definitions â”€â”€â”€
  const TABS = [
    { id: "builder", label: "Builder" },
    { id: "library", label: `Library (${library.filter(e => !e.isPlaceholder).length}/${library.length})` },
    { id: "templates", label: "Templates" },
    { id: "debugger", label: "Debugger" },
    { id: "saved", label: `Saved (${savedPrompts.length})` },
    { id: "guide", label: "Guide" }
  ];

  return (
    <div className="min-h-screen bg-slate-950 text-white">
      {/* Modal */}
      {showLibModal && (
        <LibraryModal
          entry={editingEntry}
          categories={LIBRARY_CATEGORIES}
          onSave={handleLibSave}
          onClose={() => { setShowLibModal(false); setEditingEntry(null); }}
        />
      )}

      {/* Header */}
      <header className="border-b border-slate-800 bg-slate-950/80 backdrop-blur sticky top-0 z-40">
        <div className="max-w-7xl mx-auto px-6 py-4">
          <div className="flex items-center justify-between">
            <div>
              <h1 className="text-2xl font-bold bg-gradient-to-r from-indigo-400 via-purple-400 to-pink-400 bg-clip-text text-transparent">
                Prompt Architect
              </h1>
              <p className="text-sm text-slate-500 mt-0.5">Build, remix, and debug prompts like Tony Stark builds suits</p>
            </div>
            <div className="flex gap-1.5 flex-wrap">
              {TABS.map((tab) => (
                <button key={tab.id} onClick={() => setActiveTab(tab.id)}
                  className={`px-3.5 py-2 rounded-lg text-sm font-medium transition-colors ${activeTab === tab.id ? "bg-indigo-600 text-white" : "text-slate-400 hover:text-white hover:bg-slate-800"}`}>
                  {tab.label}
                </button>
              ))}
            </div>
          </div>
        </div>
      </header>

      <main className="max-w-7xl mx-auto px-6 py-8">

        {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• BUILDER TAB â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
        {activeTab === "builder" && (
          <div className="space-y-8">
            {remixSource && (
              <div className="flex items-center gap-3 bg-purple-950/30 border border-purple-800/30 rounded-xl p-4">
                <span className="text-purple-400 text-lg">ğŸ”€</span>
                <span className="text-purple-300 text-sm">Remixing from: <strong>{remixSource}</strong></span>
                <button onClick={() => setRemixSource(null)} className="ml-auto text-xs text-purple-400 hover:text-purple-300">Dismiss</button>
              </div>
            )}

            {/* Use Case Selector */}
            <section>
              <h2 className="text-lg font-semibold text-slate-200 mb-1">What are you building?</h2>
              <p className="text-sm text-slate-500 mb-4">Select a use case for recommended tags, or go custom.</p>
              <div className="grid grid-cols-2 md:grid-cols-5 gap-3">
                {USE_CASE_PRESETS.map((preset) => (
                  <button key={preset.id} onClick={() => selectPreset(preset.id)}
                    className={`p-4 rounded-xl border-2 text-left transition-all ${selectedPreset === preset.id ? "border-indigo-500 bg-indigo-950/30" : "border-slate-700/50 bg-slate-800/30 hover:border-slate-600"}`}>
                    <div className="font-medium text-sm text-white">{preset.label}</div>
                    <div className="text-xs text-slate-400 mt-1">{preset.description}</div>
                    {preset.tags.length > 0 && <div className="text-xs text-indigo-400 mt-2">{preset.tags.length} tags</div>}
                  </button>
                ))}
              </div>
            </section>

            {/* Action Bar */}
            <div className="flex items-center justify-between flex-wrap gap-3">
              <div className="flex items-center gap-3">
                <input value={promptName} onChange={(e) => setPromptName(e.target.value)} placeholder="Name your prompt..."
                  className="bg-slate-800 border border-slate-700 rounded-lg px-3 py-2 text-sm text-white placeholder:text-slate-500 outline-none focus:border-indigo-500 w-64" />
                <button onClick={savePrompt} disabled={!promptName.trim()}
                  className="px-4 py-2 bg-emerald-600 hover:bg-emerald-500 disabled:bg-slate-700 disabled:text-slate-500 text-white text-sm font-medium rounded-lg transition-colors">Save</button>
              </div>
              <div className="flex items-center gap-2">
                <button onClick={exportPrompt} className="px-4 py-2 bg-slate-700 hover:bg-slate-600 text-white text-sm font-medium rounded-lg transition-colors">Export .txt</button>
                <button onClick={() => setShowPreview(!showPreview)}
                  className={`px-4 py-2 text-sm font-medium rounded-lg transition-colors ${showPreview ? "bg-indigo-600 text-white" : "bg-slate-700 hover:bg-slate-600 text-white"}`}>
                  {showPreview ? "Hide Preview" : "Show Preview"}
                </button>
                <button onClick={clearAll} className="px-4 py-2 bg-slate-800 hover:bg-red-900/50 text-slate-400 hover:text-red-300 text-sm rounded-lg transition-colors">Clear All</button>
              </div>
            </div>

            {/* Builder Content */}
            <div className={showPreview ? "grid grid-cols-1 lg:grid-cols-2 gap-8" : ""}>
              <div className="space-y-8">
                <section>
                  <div className="flex items-center gap-3 mb-4">
                    <h2 className="text-lg font-semibold text-slate-200">Core Tags</h2>
                    <span className="text-xs px-2 py-1 rounded-full bg-indigo-500/10 text-indigo-400">Foundation</span>
                  </div>
                  <div className="space-y-3">
                    {CORE_TAGS.map((tag) => (
                      <TagCard key={tag.id} tag={tag} value={tags[tag.id]} onChange={handleTagChange} isActive={activeTags.has(tag.id)}
                        isRecommended={selectedPreset !== "custom" && USE_CASE_PRESETS.find((p) => p.id === selectedPreset)?.tags.includes(tag.id)}
                        onToggle={(active) => handleToggleTag(tag.id, active)} />
                    ))}
                  </div>
                </section>
                <section>
                  <div className="flex items-center gap-3 mb-4">
                    <h2 className="text-lg font-semibold text-slate-200">Advanced Tags</h2>
                    <span className="text-xs px-2 py-1 rounded-full bg-purple-500/10 text-purple-400">Precision & Control</span>
                  </div>
                  <div className="space-y-3">
                    {ADVANCED_TAGS.map((tag) => (
                      <TagCard key={tag.id} tag={tag} value={tags[tag.id]} onChange={handleTagChange} isActive={activeTags.has(tag.id)}
                        isRecommended={selectedPreset !== "custom" && USE_CASE_PRESETS.find((p) => p.id === selectedPreset)?.tags.includes(tag.id)}
                        onToggle={(active) => handleToggleTag(tag.id, active)} />
                    ))}
                  </div>
                </section>
              </div>
              {showPreview && (
                <div className="lg:sticky lg:top-24 lg:self-start">
                  <h2 className="text-lg font-semibold text-slate-200 mb-4">Live Preview</h2>
                  <PreviewPanel tags={tags} activeTags={activeTags} />
                </div>
              )}
            </div>
          </div>
        )}

        {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• LIBRARY TAB â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
        {activeTab === "library" && (
          <div className="space-y-6">
            <div className="flex items-start justify-between">
              <div>
                <h2 className="text-2xl font-bold text-slate-100">Prompt Library</h2>
                <p className="text-slate-400 mt-1">Your collection of named prompts. Paste raw text, auto-detect XML tags, and remix anything into the Builder.</p>
              </div>
              <button onClick={() => { setEditingEntry(null); setShowLibModal(true); }}
                className="px-5 py-2.5 bg-indigo-600 hover:bg-indigo-500 text-white font-medium rounded-lg transition-colors flex items-center gap-2">
                <span className="text-lg">+</span> Add Prompt
              </button>
            </div>

            {/* Search & Filter */}
            <div className="flex flex-col sm:flex-row gap-4">
              <div className="relative flex-1">
                <input value={libSearch} onChange={(e) => setLibSearch(e.target.value)} placeholder="Search prompts..."
                  className="w-full bg-slate-800 border border-slate-700 rounded-lg pl-10 pr-4 py-2.5 text-sm text-white placeholder:text-slate-500 outline-none focus:border-indigo-500" />
                <svg className="absolute left-3 top-3 w-4 h-4 text-slate-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" /></svg>
              </div>
              <div className="flex flex-wrap gap-1.5">
                {LIBRARY_CATEGORIES.map((cat) => (
                  <button key={cat.id} onClick={() => setLibCategory(cat.id)}
                    className={`px-3 py-1.5 rounded-lg text-xs font-medium transition-colors ${libCategory === cat.id ? "bg-indigo-600 text-white" : "bg-slate-800 text-slate-400 hover:text-white hover:bg-slate-700"}`}>
                    {cat.icon} {cat.label}
                  </button>
                ))}
              </div>
            </div>

            {/* Library Grid */}
            {filteredLibrary.length === 0 ? (
              <div className="text-center py-16">
                <div className="text-5xl mb-4">ğŸ“­</div>
                <p className="text-slate-400 mb-2">{libSearch ? "No prompts match your search" : "No prompts in this category yet"}</p>
                <button onClick={() => { setEditingEntry(null); setShowLibModal(true); }}
                  className="mt-4 px-5 py-2.5 bg-indigo-600 hover:bg-indigo-500 text-white font-medium rounded-lg transition-colors">
                  Add Your First Prompt
                </button>
              </div>
            ) : (
              <div className="grid gap-4 md:grid-cols-2">
                {filteredLibrary.map((entry) => {
                  const catInfo = LIBRARY_CATEGORIES.find(c => c.id === entry.category);
                  const isExpanded = expandedLibEntry === entry.id;
                  const { parsed, hasXmlTags } = entry.rawPrompt ? parseXmlTags(entry.rawPrompt) : { parsed: {}, hasXmlTags: false };
                  const tagCount = Object.keys(parsed).length;

                  return (
                    <div key={entry.id}
                      className={`rounded-xl border-2 transition-all ${entry.isPlaceholder ? "border-dashed border-slate-700/50 bg-slate-800/20" : "border-slate-700/50 bg-slate-800/40 hover:border-slate-600"}`}>
                      <div className="p-5">
                        <div className="flex items-start justify-between gap-3">
                          <div className="min-w-0 flex-1">
                            <div className="flex items-center gap-2 flex-wrap">
                              <h3 className="font-bold text-white text-lg">{entry.name}</h3>
                              {catInfo && <span className="text-xs px-2 py-0.5 rounded-full bg-slate-700/50 text-slate-400">{catInfo.icon} {catInfo.label}</span>}
                              {entry.isPlaceholder && <span className="text-xs px-2 py-0.5 rounded-full bg-amber-900/30 text-amber-400">Empty slot</span>}
                            </div>
                            <p className="text-sm text-slate-400 mt-1.5 line-clamp-2">{entry.description}</p>
                            {!entry.isPlaceholder && hasXmlTags && (
                              <div className="flex flex-wrap gap-1 mt-2">
                                {Object.keys(parsed).map(t => <span key={t} className="text-xs px-1.5 py-0.5 rounded bg-emerald-900/30 text-emerald-400 font-mono">&lt;{t}&gt;</span>)}
                              </div>
                            )}
                            {!entry.isPlaceholder && !hasXmlTags && entry.rawPrompt && (
                              <div className="text-xs text-slate-500 mt-2">{entry.rawPrompt.split(/\s+/).length} words (plain text)</div>
                            )}
                          </div>
                        </div>

                        {/* Actions */}
                        <div className="flex items-center gap-2 mt-4 flex-wrap">
                          {entry.isPlaceholder ? (
                            <button onClick={() => { setEditingEntry(entry); setShowLibModal(true); }}
                              className="px-4 py-2 bg-indigo-600 hover:bg-indigo-500 text-white text-sm font-medium rounded-lg transition-colors">
                              Add Prompt Text
                            </button>
                          ) : (
                            <>
                              <button onClick={() => loadLibraryEntry(entry)}
                                className="px-4 py-2 bg-indigo-600 hover:bg-indigo-500 text-white text-sm font-medium rounded-lg transition-colors">
                                Load in Builder
                              </button>
                              <button onClick={() => copyRawPrompt(entry.rawPrompt)}
                                className="px-3 py-2 bg-slate-700 hover:bg-slate-600 text-white text-sm rounded-lg transition-colors">
                                Copy
                              </button>
                              <button onClick={() => setExpandedLibEntry(isExpanded ? null : entry.id)}
                                className="px-3 py-2 bg-slate-700 hover:bg-slate-600 text-slate-300 text-sm rounded-lg transition-colors">
                                {isExpanded ? "Hide" : "Preview"}
                              </button>
                            </>
                          )}
                          <button onClick={() => { setEditingEntry(entry); setShowLibModal(true); }}
                            className="px-3 py-2 bg-slate-800 hover:bg-slate-700 text-slate-400 text-sm rounded-lg transition-colors">
                            Edit
                          </button>
                          <button onClick={() => setLibrary(prev => prev.filter(e => e.id !== entry.id))}
                            className="px-3 py-2 bg-slate-800 hover:bg-red-900/50 text-slate-500 hover:text-red-300 text-sm rounded-lg transition-colors ml-auto">
                            Remove
                          </button>
                        </div>

                        {/* Expanded Preview */}
                        {isExpanded && entry.rawPrompt && (
                          <pre className="mt-4 bg-slate-950 rounded-lg p-4 text-xs text-slate-400 font-mono whitespace-pre-wrap overflow-auto max-h-64 border border-slate-800">
                            {entry.rawPrompt}
                          </pre>
                        )}
                      </div>
                    </div>
                  );
                })}
              </div>
            )}

            {/* Stats Footer */}
            <div className="text-center pt-4 border-t border-slate-800">
              <p className="text-sm text-slate-500">
                {library.length} total entries &middot; {library.filter(e => !e.isPlaceholder).length} with prompts &middot; {library.filter(e => e.isPlaceholder).length} empty slots
              </p>
            </div>
          </div>
        )}

        {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• TEMPLATES TAB â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
        {activeTab === "templates" && (
          <div className="space-y-8">
            <div>
              <h2 className="text-2xl font-bold text-slate-100">Prompt Templates</h2>
              <p className="text-slate-400 mt-1">Battle-tested prompts. Load one, then remix it.</p>
            </div>
            <div className="grid gap-6">
              {BUILT_IN_TEMPLATES.map((template) => (
                <div key={template.id} className="rounded-xl border-2 border-slate-700/50 bg-slate-800/30 overflow-hidden hover:border-slate-600 transition-colors">
                  <div className="p-6">
                    <div className="flex items-start justify-between">
                      <div>
                        <h3 className="text-xl font-bold text-white">{template.name}</h3>
                        <p className="text-slate-400 mt-1">{template.description}</p>
                        <p className="text-sm text-indigo-400 mt-2">Best for: {template.useCase}</p>
                      </div>
                      <div className="flex gap-2">
                        <button onClick={() => {
                          const raw = Object.entries(template.tags).map(([id, val]) => `<${id}>\n${val}\n</${id}>`).join("\n\n");
                          handleLibSave({ id: `lib_tpl_${template.id}`, name: template.name, category: "custom", description: template.description, rawPrompt: raw, isPlaceholder: false, savedAt: new Date().toISOString() });
                        }} className="px-4 py-2.5 bg-slate-700 hover:bg-slate-600 text-white font-medium rounded-lg transition-colors whitespace-nowrap text-sm">
                          Save to Library
                        </button>
                        <button onClick={() => loadTemplate(template)}
                          className="px-5 py-2.5 bg-indigo-600 hover:bg-indigo-500 text-white font-medium rounded-lg transition-colors whitespace-nowrap">
                          Load & Remix
                        </button>
                      </div>
                    </div>
                    <div className="mt-4 flex flex-wrap gap-2">
                      {Object.keys(template.tags).map((tagId) => (
                        <span key={tagId} className="text-xs px-2.5 py-1 rounded-full bg-slate-700/50 text-slate-300 font-mono">&lt;{tagId}&gt;</span>
                      ))}
                    </div>
                    <details className="mt-4">
                      <summary className="text-sm text-slate-500 hover:text-slate-300 cursor-pointer">Preview prompt structure...</summary>
                      <pre className="mt-3 bg-slate-950 rounded-lg p-4 text-xs text-slate-400 font-mono whitespace-pre-wrap overflow-auto max-h-80 border border-slate-800">
                        {Object.entries(template.tags).map(([id, val]) => `<${id}>\n${val}\n</${id}>`).join("\n\n")}
                      </pre>
                    </details>
                  </div>
                </div>
              ))}
            </div>
            <div className="text-center py-8 border-t border-slate-800">
              <p className="text-slate-400 mb-3">Don't see what you need? Build your own.</p>
              <button onClick={() => { clearAll(); setActiveTab("builder"); }}
                className="px-6 py-3 bg-indigo-600 hover:bg-indigo-500 text-white font-medium rounded-lg transition-colors">Start Fresh in Builder</button>
            </div>
          </div>
        )}

        {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• DEBUGGER TAB â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
        {activeTab === "debugger" && (
          <div className="space-y-8">
            <div>
              <h2 className="text-2xl font-bold text-slate-100">Prompt Debugger</h2>
              <p className="text-slate-400 mt-1">Select symptoms to get a targeted diagnosis.</p>
            </div>
            <div className="grid gap-4">
              {DEBUG_SYMPTOMS.map((item) => {
                const isChecked = debugChecked.has(item.id);
                return (
                  <div key={item.id} onClick={() => { setDebugChecked((prev) => { const next = new Set(prev); if (next.has(item.id)) next.delete(item.id); else next.add(item.id); return next; }); }}
                    className={`rounded-xl border-2 p-5 cursor-pointer transition-all ${isChecked ? "border-red-500/50 bg-red-950/20" : "border-slate-700/50 bg-slate-800/30 hover:border-slate-600"}`}>
                    <div className="flex items-start gap-4">
                      <div className="flex items-center gap-3 min-w-0 flex-1">
                        <span className="text-2xl flex-shrink-0">{item.icon}</span>
                        <div className="min-w-0">
                          <h3 className="font-semibold text-white">{item.symptom}</h3>
                          {isChecked && (
                            <div className="mt-3 space-y-3">
                              <div className="bg-slate-900/80 rounded-lg p-3 border border-slate-700/50">
                                <div className="text-sm font-medium text-red-400 mb-1">Diagnosis</div>
                                <p className="text-sm text-slate-300">{item.diagnosis}</p>
                              </div>
                              <div className="bg-slate-900/80 rounded-lg p-3 border border-slate-700/50">
                                <div className="text-sm font-medium text-emerald-400 mb-1">Fix</div>
                                <p className="text-sm text-slate-300">{item.fix}</p>
                              </div>
                              <button onClick={(e) => { e.stopPropagation(); handleToggleTag(item.tagToFix, true); setActiveTab("builder"); }}
                                className="text-sm text-indigo-400 hover:text-indigo-300 font-medium">Go fix &lt;{item.tagToFix}&gt; in Builder &rarr;</button>
                            </div>
                          )}
                        </div>
                      </div>
                      <div className={`w-6 h-6 rounded border-2 flex items-center justify-center flex-shrink-0 transition-colors ${isChecked ? "bg-red-500 border-red-500" : "border-slate-600"}`}>
                        {isChecked && <svg className="w-4 h-4 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={3} d="M5 13l4 4L19 7" /></svg>}
                      </div>
                    </div>
                  </div>
                );
              })}
            </div>
            {debugChecked.size > 0 && (
              <div className="bg-slate-800/50 rounded-xl border border-slate-700/50 p-6">
                <h3 className="font-semibold text-white mb-3">Summary: {debugChecked.size} issue{debugChecked.size > 1 ? "s" : ""} identified</h3>
                <div className="flex flex-wrap gap-2">
                  {[...debugChecked].map((id) => { const item = DEBUG_SYMPTOMS.find((s) => s.id === id); return (
                    <span key={id} className="text-sm px-3 py-1.5 rounded-lg bg-indigo-500/10 text-indigo-300 font-mono">Fix &lt;{item.tagToFix}&gt;</span>
                  ); })}
                </div>
                <button onClick={() => { [...debugChecked].forEach((id) => { const item = DEBUG_SYMPTOMS.find((s) => s.id === id); handleToggleTag(item.tagToFix, true); }); setActiveTab("builder"); }}
                  className="mt-4 px-5 py-2.5 bg-indigo-600 hover:bg-indigo-500 text-white font-medium rounded-lg transition-colors">Open Builder with these tags enabled</button>
              </div>
            )}
          </div>
        )}

        {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• SAVED TAB â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
        {activeTab === "saved" && (
          <div className="space-y-8">
            <div>
              <h2 className="text-2xl font-bold text-slate-100">Saved Prompts</h2>
              <p className="text-slate-400 mt-1">Prompts you've built in the Builder and saved.</p>
            </div>
            {savedPrompts.length === 0 ? (
              <div className="text-center py-16">
                <div className="text-5xl mb-4">ğŸ“</div>
                <p className="text-slate-400 mb-2">No saved prompts yet</p>
                <p className="text-sm text-slate-500 mb-6">Build a prompt in the Builder tab and save it.</p>
                <button onClick={() => setActiveTab("builder")} className="px-5 py-2.5 bg-indigo-600 hover:bg-indigo-500 text-white font-medium rounded-lg transition-colors">Go to Builder</button>
              </div>
            ) : (
              <div className="grid gap-4">
                {savedPrompts.map((prompt) => (
                  <div key={prompt.id} className="rounded-xl border-2 border-slate-700/50 bg-slate-800/30 p-5 hover:border-slate-600 transition-colors">
                    <div className="flex items-center justify-between">
                      <div>
                        <h3 className="font-semibold text-white text-lg">{prompt.name}</h3>
                        <div className="flex items-center gap-3 mt-1">
                          <span className="text-xs text-slate-500">{new Date(prompt.savedAt).toLocaleDateString()}</span>
                          <span className="text-xs text-slate-500">{prompt.activeTags.length} tags</span>
                        </div>
                        <div className="flex flex-wrap gap-1.5 mt-2">
                          {prompt.activeTags.filter((id) => prompt.tags[id]?.trim()).map((id) => (
                            <span key={id} className="text-xs px-2 py-0.5 rounded bg-slate-700/50 text-slate-400 font-mono">&lt;{id}&gt;</span>
                          ))}
                        </div>
                      </div>
                      <div className="flex gap-2">
                        <button onClick={() => {
                          const order = ["role","mission","context","persona","tone","audience","knowledge","rules","constraints","method","anti_patterns","fallback","discovery_engine","output_format","examples","evaluation","chain"];
                          const raw = order.filter(id => prompt.activeTags.includes(id) && prompt.tags[id]?.trim()).map(id => `<${id}>\n${prompt.tags[id].trim()}\n</${id}>`).join("\n\n");
                          handleLibSave({ id: `lib_saved_${prompt.id}`, name: prompt.name, category: "custom", description: `Saved prompt with ${prompt.activeTags.length} tags`, rawPrompt: raw, isPlaceholder: false, savedAt: prompt.savedAt });
                        }} className="px-3 py-2 bg-slate-700 hover:bg-slate-600 text-white text-sm rounded-lg transition-colors">To Library</button>
                        <button onClick={() => loadSavedPrompt(prompt)} className="px-4 py-2 bg-indigo-600 hover:bg-indigo-500 text-white text-sm font-medium rounded-lg transition-colors">Load & Remix</button>
                        <button onClick={() => setSavedPrompts((prev) => prev.filter((p) => p.id !== prompt.id))}
                          className="px-3 py-2 bg-slate-800 hover:bg-red-900/50 text-slate-400 hover:text-red-300 text-sm rounded-lg transition-colors">Delete</button>
                      </div>
                    </div>
                  </div>
                ))}
              </div>
            )}
          </div>
        )}
        {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• GUIDE TAB â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
        {activeTab === "guide" && (
          <div className="space-y-10 max-w-4xl mx-auto">
            {/* Hero */}
            <div className="text-center py-6">
              <h2 className="text-3xl font-bold bg-gradient-to-r from-indigo-400 via-purple-400 to-pink-400 bg-clip-text text-transparent">
                How to Use Prompt Architect
              </h2>
              <p className="text-slate-400 mt-3 text-lg max-w-2xl mx-auto">
                A complete beginner's guide to building powerful prompts. No experience required.
              </p>
            </div>

            {/* Table of Contents */}
            <div className="bg-slate-800/40 rounded-xl border border-slate-700/50 p-6">
              <h3 className="text-lg font-bold text-white mb-4">Table of Contents</h3>
              <div className="grid grid-cols-1 sm:grid-cols-2 gap-2">
                {[
                  ["1", "What Is This App?"],
                  ["2", "What Is a Prompt?"],
                  ["3", "Why XML Tags Matter"],
                  ["4", "The Builder Tab â€” Your Main Workspace"],
                  ["5", "Core Tags Explained (The Big 6)"],
                  ["6", "Advanced Tags (Power User)"],
                  ["7", "The Library Tab â€” Store & Organize"],
                  ["8", "The Templates Tab â€” Start From Proven Prompts"],
                  ["9", "The Debugger Tab â€” Fix What's Broken"],
                  ["10", "The Saved Tab â€” Your Session History"],
                  ["11", "Complete Walkthrough: Your First Prompt"],
                  ["12", "Tips, Tricks & Common Mistakes"],
                ].map(([num, title]) => (
                  <div key={num} className="flex items-center gap-2 text-sm">
                    <span className="w-7 h-7 rounded-lg bg-indigo-600/20 text-indigo-400 flex items-center justify-center text-xs font-bold flex-shrink-0">{num}</span>
                    <span className="text-slate-300">{title}</span>
                  </div>
                ))}
              </div>
            </div>

            {/* Section 1 */}
            <section className="space-y-4">
              <div className="flex items-center gap-3">
                <span className="w-10 h-10 rounded-xl bg-indigo-600/20 text-indigo-400 flex items-center justify-center font-bold">1</span>
                <h3 className="text-xl font-bold text-white">What Is This App?</h3>
              </div>
              <div className="bg-slate-800/30 rounded-xl border border-slate-700/50 p-6 space-y-4 text-slate-300 text-[15px] leading-relaxed">
                <p>Prompt Architect is a tool that helps you build, organize, and fix prompts for AI chatbots like ChatGPT, Claude, Gemini, or any other Large Language Model (LLM).</p>
                <p>Instead of typing random sentences into AI and hoping for the best, this app gives you a structured system â€” like a recipe â€” that tells the AI exactly who to be, what to do, how to behave, and what the output should look like.</p>
                <p>Think of it this way: typing a wish into AI is like telling a chef "make me something good." Using Prompt Architect is like handing the chef a detailed recipe with ingredients, measurements, cooking times, and a photo of the finished dish.</p>
                <p className="text-indigo-400 font-medium">The result? Better, more consistent, more useful AI responses. Every single time.</p>
              </div>
            </section>

            {/* Section 2 */}
            <section className="space-y-4">
              <div className="flex items-center gap-3">
                <span className="w-10 h-10 rounded-xl bg-indigo-600/20 text-indigo-400 flex items-center justify-center font-bold">2</span>
                <h3 className="text-xl font-bold text-white">What Is a Prompt?</h3>
              </div>
              <div className="bg-slate-800/30 rounded-xl border border-slate-700/50 p-6 space-y-4 text-slate-300 text-[15px] leading-relaxed">
                <p>A <strong className="text-white">prompt</strong> is the instruction you give to an AI. It can be as simple as "What's the weather?" or as complex as a multi-page system instruction that turns an AI into a specialized expert.</p>
                <p>Most people write prompts like this:</p>
                <div className="bg-red-950/30 border border-red-800/30 rounded-lg p-4 font-mono text-sm text-red-300">"Help me write a good marketing email"</div>
                <p>That's vague. The AI has to guess everything: who's the audience? What product? What tone? How long? What format? Every guess is a place where the output can go wrong.</p>
                <p>A well-built prompt looks more like this:</p>
                <div className="bg-emerald-950/30 border border-emerald-800/30 rounded-lg p-4 font-mono text-sm text-emerald-300 whitespace-pre-wrap">{`<role>\nYou are a direct-response email copywriter with \n10 years of experience in SaaS B2B marketing.\n</role>\n\n<mission>\nWrite a 3-email nurture sequence for trial users \nwho signed up but haven't activated. Each email \nshould be under 150 words.\n</mission>\n\n<output_format>\nReturn each email with: Subject line, Preview \ntext, Body, and a single CTA button text.\n</output_format>`}</div>
                <p className="text-indigo-400 font-medium">This app helps you build that second version â€” step by step, with guidance at every stage.</p>
              </div>
            </section>

            {/* Section 3 */}
            <section className="space-y-4">
              <div className="flex items-center gap-3">
                <span className="w-10 h-10 rounded-xl bg-indigo-600/20 text-indigo-400 flex items-center justify-center font-bold">3</span>
                <h3 className="text-xl font-bold text-white">Why XML Tags Matter</h3>
              </div>
              <div className="bg-slate-800/30 rounded-xl border border-slate-700/50 p-6 space-y-4 text-slate-300 text-[15px] leading-relaxed">
                <p>XML tags are the labeled containers that hold each piece of your prompt. They look like this:</p>
                <div className="bg-slate-900 rounded-lg p-4 font-mono text-sm text-indigo-300">{`<role> ... </role>\n<mission> ... </mission>\n<rules> ... </rules>`}</div>
                <p>Why do they matter? Because when you write a prompt in plain paragraphs, the AI has to <em>guess</em> where the role ends and the task begins, where the rules are, and what the output should look like. Every guess is a potential mistake.</p>
                <p>XML tags eliminate guessing. Each tag is a boundary â€” a decision <em>you</em> made so the AI doesn't have to. This is the same approach that Anthropic (the company behind Claude) uses in their own system prompts.</p>
                <p className="text-amber-400 font-medium">You don't need to understand programming or XML to use them. This app handles all the formatting for you. You just fill in the content.</p>
              </div>
            </section>

            {/* Section 4 */}
            <section className="space-y-4">
              <div className="flex items-center gap-3">
                <span className="w-10 h-10 rounded-xl bg-indigo-600/20 text-indigo-400 flex items-center justify-center font-bold">4</span>
                <h3 className="text-xl font-bold text-white">The Builder Tab â€” Your Main Workspace</h3>
              </div>
              <div className="bg-slate-800/30 rounded-xl border border-slate-700/50 p-6 space-y-4 text-slate-300 text-[15px] leading-relaxed">
                <p>The Builder is where you construct your prompt piece by piece. Here's how it works:</p>
                <div className="space-y-3">
                  <div className="bg-slate-900/60 rounded-lg p-4">
                    <p className="text-white font-semibold mb-2">Step 1: Choose a Use Case</p>
                    <p>At the top, you'll see five preset buttons: <strong className="text-indigo-400">Simple Task</strong>, <strong className="text-indigo-400">Professional</strong>, <strong className="text-indigo-400">Interactive</strong>, <strong className="text-indigo-400">Complex Workflow</strong>, and <strong className="text-indigo-400">Custom</strong>. Click one and the app will automatically recommend which tags you should use. If you're brand new, start with <strong>Simple Task</strong> (3 tags) or <strong>Professional</strong> (6 tags).</p>
                  </div>
                  <div className="bg-slate-900/60 rounded-lg p-4">
                    <p className="text-white font-semibold mb-2">Step 2: Fill In Your Tags</p>
                    <p>Each tag has a <strong className="text-indigo-400">toggle switch</strong> on the right. Turn it on to activate a tag. Once active, a text area appears where you type your content. Each tag also has placeholder text showing you an example of what good content looks like â€” use it as inspiration. Click <strong>"Show tips & common mistakes"</strong> to see what NOT to do.</p>
                  </div>
                  <div className="bg-slate-900/60 rounded-lg p-4">
                    <p className="text-white font-semibold mb-2">Step 3: Preview Your Prompt</p>
                    <p>Click the <strong className="text-indigo-400">Show Preview</strong> button in the action bar. A live preview panel appears on the right side showing your complete XML prompt as you type. It updates in real time and shows word count, character count, and number of active tags.</p>
                  </div>
                  <div className="bg-slate-900/60 rounded-lg p-4">
                    <p className="text-white font-semibold mb-2">Step 4: Copy or Export</p>
                    <p>When you're done, click <strong className="text-indigo-400">Copy Prompt</strong> in the preview panel to copy to your clipboard, then paste it directly into ChatGPT, Claude, or any AI. You can also click <strong>Export .txt</strong> to save it as a text file, or type a name and click <strong>Save</strong> to store it in the app.</p>
                  </div>
                </div>
              </div>
            </section>

            {/* Section 5 */}
            <section className="space-y-4">
              <div className="flex items-center gap-3">
                <span className="w-10 h-10 rounded-xl bg-indigo-600/20 text-indigo-400 flex items-center justify-center font-bold">5</span>
                <h3 className="text-xl font-bold text-white">Core Tags Explained (The Big 6)</h3>
              </div>
              <div className="bg-slate-800/30 rounded-xl border border-slate-700/50 p-6 space-y-5 text-slate-300 text-[15px] leading-relaxed">
                <p>These six tags are the foundation of almost every prompt. Most prompts need all or most of them.</p>
                {[
                  ["ğŸ­", "role", "Who the AI becomes", "This sets the AI's identity and expertise. Don't say 'helpful assistant' â€” that's the default. Instead, give it a specific job title, years of experience, and area of specialization. The more specific you are, the better the output.", "\"You are a senior brand strategist with 15 years of experience building consumer brands from zero to acquisition.\""],
                  ["ğŸ¯", "mission", "What the AI does", "This is the directive â€” the actual task. Be specific about what goes in, what comes out, and what the AI should NOT do. If your mission can be interpreted three ways, the AI will pick one at random.", "\"Analyze the user's draft and provide specific feedback on structure, clarity, and persuasion. Identify the three weakest points and rewrite them as examples.\""],
                  ["ğŸ“", "rules", "How the AI behaves", "Rules control the AI's behavior â€” not what it produces, but how it acts. Think 'always do this' and 'never do that.' These override the AI's default habits like bullet-pointing everything or making assumptions.", "\"Never assume context the user hasn't provided. If information is missing, ask. Do not give generic advice.\""],
                  ["ğŸ”’", "constraints", "Hard limits on the output", "Constraints are the boundaries on the output itself: word counts, character limits, language, things to avoid. Rules = behavior. Constraints = output.", "\"Response must be under 280 characters. All recommendations must be implementable within 30 days.\""],
                  ["ğŸ“‹", "output_format", "What the output looks like", "This is the most overlooked tag. Without it, you get whatever the AI feels like giving you. With it, you get exactly the shape you need â€” a paragraph, a table, JSON, a report with sections, a single sentence.", "\"Return a single paragraph of no more than 3 sentences summarizing the core finding. Follow with a confidence score from 1-10.\""],
                  ["ğŸ’¡", "examples", "Show what good looks like", "The single most powerful tag. One concrete example teaches the AI more than a paragraph of instructions. It shows the format, depth, tone, and reasoning all at once. Two examples is usually enough.", "Include a sample user input and the ideal response, showing the exact format and depth you expect."],
                ].map(([icon, tag, title, desc, example]) => (
                  <div key={tag} className="bg-slate-900/40 rounded-lg p-4 space-y-2">
                    <div className="flex items-center gap-2">
                      <span className="text-xl">{icon}</span>
                      <span className="font-mono text-indigo-400 font-bold">&lt;{tag}&gt;</span>
                      <span className="text-white font-semibold">â€” {title}</span>
                    </div>
                    <p>{desc}</p>
                    <div className="bg-slate-950 rounded p-3 text-sm font-mono text-emerald-300/80">{example}</div>
                  </div>
                ))}
              </div>
            </section>

            {/* Section 6 */}
            <section className="space-y-4">
              <div className="flex items-center gap-3">
                <span className="w-10 h-10 rounded-xl bg-indigo-600/20 text-indigo-400 flex items-center justify-center font-bold">6</span>
                <h3 className="text-xl font-bold text-white">Advanced Tags (Power User)</h3>
              </div>
              <div className="bg-slate-800/30 rounded-xl border border-slate-700/50 p-6 space-y-4 text-slate-300 text-[15px] leading-relaxed">
                <p>You don't need these for every prompt. Reach for them when the core tags aren't enough.</p>
                <div className="grid gap-3">
                  {[
                    ["ğŸŒ", "context", "Background info the AI needs before acting (user's situation, project details, industry)."],
                    ["ğŸ—£ï¸", "persona", "The AI's personality and communication style â€” separate from its expertise."],
                    ["ğŸµ", "tone", "The emotional register: confident, empathetic, blunt, warm, formal, casual."],
                    ["ğŸ‘¥", "audience", "Who reads the output â€” shifts vocabulary and complexity automatically."],
                    ["ğŸ“š", "knowledge", "Specific facts to inject: pricing, product info, company policies."],
                    ["ğŸ”„", "method", "Step-by-step process the AI follows in order. Prevents it from skipping ahead."],
                    ["ğŸš«", "anti_patterns", "Show what BAD output looks like with examples. More effective than abstract rules."],
                    ["ğŸ›Ÿ", "fallback", "What to do when the AI can't answer. Prevents hallucination and confident guessing."],
                    ["âœ…", "evaluation", "Self-check criteria the AI applies before delivering its response."],
                    ["ğŸ”", "discovery_engine", "Questions the AI asks YOU before acting. Flips the dynamic so it extracts what it needs."],
                    ["ğŸ”—", "chain", "Links this prompt to others in a multi-step workflow. Output of one feeds into the next."],
                  ].map(([icon, tag, desc]) => (
                    <div key={tag} className="flex items-start gap-3 bg-slate-900/30 rounded-lg p-3">
                      <span className="text-lg mt-0.5">{icon}</span>
                      <div>
                        <span className="font-mono text-purple-400 font-semibold">&lt;{tag}&gt;</span>
                        <span className="text-slate-400 ml-2 text-sm">{desc}</span>
                      </div>
                    </div>
                  ))}
                </div>
              </div>
            </section>

            {/* Section 7 */}
            <section className="space-y-4">
              <div className="flex items-center gap-3">
                <span className="w-10 h-10 rounded-xl bg-indigo-600/20 text-indigo-400 flex items-center justify-center font-bold">7</span>
                <h3 className="text-xl font-bold text-white">The Library Tab â€” Store & Organize</h3>
              </div>
              <div className="bg-slate-800/30 rounded-xl border border-slate-700/50 p-6 space-y-4 text-slate-300 text-[15px] leading-relaxed">
                <p>The Library is your personal collection of named prompts â€” think of it as a recipe book.</p>
                <div className="space-y-3">
                  <div className="bg-slate-900/60 rounded-lg p-4">
                    <p className="text-white font-semibold mb-1">Adding a prompt</p>
                    <p>Click the <strong className="text-indigo-400">+ Add Prompt</strong> button. Give it a name (like "Code Auditor"), pick a category, write a short description, and paste the full prompt text into the big text area. If your prompt uses XML tags, the app will auto-detect them and show green badges.</p>
                  </div>
                  <div className="bg-slate-900/60 rounded-lg p-4">
                    <p className="text-white font-semibold mb-1">Using empty slots</p>
                    <p>The Library comes with pre-named empty slots (Open Claw, Code Auditor, Debug Agent, etc.). Click <strong className="text-indigo-400">Add Prompt Text</strong> on any empty slot to fill it in. These are starting points â€” rename or delete them freely.</p>
                  </div>
                  <div className="bg-slate-900/60 rounded-lg p-4">
                    <p className="text-white font-semibold mb-1">Searching & filtering</p>
                    <p>Use the search bar to find prompts by name or description. Use the category buttons (AI Agents, Code & Dev, Design & UX, Strategy, etc.) to filter by type.</p>
                  </div>
                  <div className="bg-slate-900/60 rounded-lg p-4">
                    <p className="text-white font-semibold mb-1">Loading into the Builder</p>
                    <p>Click <strong className="text-indigo-400">Load in Builder</strong> on any library entry. If it has XML tags, they'll be parsed and placed into the correct tag fields automatically. You can then edit, remix, and re-save.</p>
                  </div>
                </div>
              </div>
            </section>

            {/* Section 8 */}
            <section className="space-y-4">
              <div className="flex items-center gap-3">
                <span className="w-10 h-10 rounded-xl bg-indigo-600/20 text-indigo-400 flex items-center justify-center font-bold">8</span>
                <h3 className="text-xl font-bold text-white">The Templates Tab â€” Start From Proven Prompts</h3>
              </div>
              <div className="bg-slate-800/30 rounded-xl border border-slate-700/50 p-6 space-y-4 text-slate-300 text-[15px] leading-relaxed">
                <p>Templates are fully built, battle-tested prompts you can use immediately or remix. The app includes three:</p>
                <div className="space-y-2">
                  <div className="bg-slate-900/60 rounded-lg p-3">
                    <span className="text-white font-semibold">Voice Style Extractor</span>
                    <span className="text-slate-400 ml-2">â€” Give it any writing sample and it reverse-engineers the author's voice into a reusable prompt.</span>
                  </div>
                  <div className="bg-slate-900/60 rounded-lg p-3">
                    <span className="text-white font-semibold">Keyword & Sentiment Search Engine</span>
                    <span className="text-slate-400 ml-2">â€” Turns AI into a research analyst that monitors topics and reports on sentiment and trends.</span>
                  </div>
                  <div className="bg-slate-900/60 rounded-lg p-3">
                    <span className="text-white font-semibold">The Idea Interrogator</span>
                    <span className="text-slate-400 ml-2">â€” Forces AI to tear apart your idea with ruthless questions before writing a single line of code.</span>
                  </div>
                </div>
                <p>Click <strong className="text-indigo-400">Load & Remix</strong> to drop any template into the Builder. Click <strong>Save to Library</strong> to add it to your permanent collection. Click <strong>Preview prompt structure</strong> to see the full XML before loading.</p>
              </div>
            </section>

            {/* Section 9 */}
            <section className="space-y-4">
              <div className="flex items-center gap-3">
                <span className="w-10 h-10 rounded-xl bg-indigo-600/20 text-indigo-400 flex items-center justify-center font-bold">9</span>
                <h3 className="text-xl font-bold text-white">The Debugger Tab â€” Fix What's Broken</h3>
              </div>
              <div className="bg-slate-800/30 rounded-xl border border-slate-700/50 p-6 space-y-4 text-slate-300 text-[15px] leading-relaxed">
                <p>If you've used a prompt and the AI's output isn't what you expected, the Debugger helps you figure out which tag to fix.</p>
                <p><strong className="text-white">How to use it:</strong> Check the boxes next to any symptoms you're experiencing. The app will show you a diagnosis (which tag is likely the problem) and a specific fix. You can then click <strong className="text-indigo-400">"Go fix &lt;tag&gt; in Builder"</strong> to jump directly to that tag.</p>
                <div className="grid grid-cols-1 sm:grid-cols-2 gap-2 mt-2">
                  {[
                    ["ğŸ˜", "Output is generic", "Fix your <role>"],
                    ["ğŸ“", "Wrong format", "Fix your <output_format>"],
                    ["ğŸ™‰", "Ignores instructions", "Fix your <rules>"],
                    ["ğŸ¬", "Sugarcoating", "Add <anti_patterns>"],
                    ["ğŸ¯", "Misses the point", "Fix your <mission>"],
                    ["ğŸŒ€", "Makes up facts", "Add <fallback>"],
                    ["ğŸ°", "Inconsistent results", "Add <examples>"],
                    ["ğŸ”€", "Right answer wrong way", "Add <method>"],
                  ].map(([icon, symptom, fix]) => (
                    <div key={symptom} className="flex items-center gap-2 text-sm bg-slate-900/40 rounded-lg p-2">
                      <span>{icon}</span>
                      <span className="text-slate-400">{symptom}</span>
                      <span className="text-indigo-400 ml-auto font-mono text-xs">{fix}</span>
                    </div>
                  ))}
                </div>
              </div>
            </section>

            {/* Section 10 */}
            <section className="space-y-4">
              <div className="flex items-center gap-3">
                <span className="w-10 h-10 rounded-xl bg-indigo-600/20 text-indigo-400 flex items-center justify-center font-bold">10</span>
                <h3 className="text-xl font-bold text-white">The Saved Tab â€” Your Session History</h3>
              </div>
              <div className="bg-slate-800/30 rounded-xl border border-slate-700/50 p-6 space-y-4 text-slate-300 text-[15px] leading-relaxed">
                <p>Every time you name a prompt in the Builder and click <strong className="text-indigo-400">Save</strong>, it appears here. You can:</p>
                <div className="space-y-2">
                  <p><strong className="text-white">Load & Remix</strong> â€” Bring a saved prompt back into the Builder for editing.</p>
                  <p><strong className="text-white">To Library</strong> â€” Move a saved prompt to your permanent Library with categories and search.</p>
                  <p><strong className="text-white">Delete</strong> â€” Remove prompts you no longer need.</p>
                </div>
                <p className="text-amber-400 text-sm">Note: Saved prompts are stored in your browser session. For permanent storage, use the Library tab or Export as .txt.</p>
              </div>
            </section>

            {/* Section 11 */}
            <section className="space-y-4">
              <div className="flex items-center gap-3">
                <span className="w-10 h-10 rounded-xl bg-indigo-600/20 text-indigo-400 flex items-center justify-center font-bold">11</span>
                <h3 className="text-xl font-bold text-white">Complete Walkthrough: Your First Prompt</h3>
              </div>
              <div className="bg-slate-800/30 rounded-xl border border-slate-700/50 p-6 space-y-4 text-slate-300 text-[15px] leading-relaxed">
                <p className="text-white font-semibold text-lg">Let's build a prompt together, step by step.</p>
                <p>Scenario: You want an AI to review your resume and give you honest feedback.</p>
                <div className="space-y-3">
                  {[
                    ["1", "Go to the Builder tab", "Click 'Builder' in the top navigation."],
                    ["2", "Select 'Professional' preset", "This activates 6 recommended tags: role, mission, rules, constraints, output_format, and examples."],
                    ["3", "Fill in <role>", "Type: \"You are a senior hiring manager with 15 years of experience screening resumes for Fortune 500 tech companies. You specialize in identifying what makes candidates stand out â€” and what gets them rejected.\""],
                    ["4", "Fill in <mission>", "Type: \"The user will provide their resume. Analyze it section by section. Identify the 3 strongest points and the 3 weakest points. For each weak point, provide a specific rewrite. Do not rewrite the entire resume.\""],
                    ["5", "Fill in <rules>", "Type: \"Be direct and honest. Do not sugarcoat. If something is bad, say so and explain why. Do not use vague advice like 'make it more impactful.' Every suggestion must be specific and actionable.\""],
                    ["6", "Fill in <constraints>", "Type: \"Focus only on content and positioning, not visual formatting. Assume the resume will be read by an ATS system first, then a human. Keep total response under 800 words.\""],
                    ["7", "Fill in <output_format>", "Type: \"For each section of the resume, provide: SCORE (1-10), STRENGTHS (bullet points), WEAKNESSES (with specific rewrites), and VERDICT (one sentence). End with an overall score and the single most impactful change.\""],
                    ["8", "Click 'Show Preview'", "See your complete prompt with all XML tags properly formatted."],
                    ["9", "Click 'Copy Prompt'", "Paste it into ChatGPT or Claude, then paste your resume below it."],
                    ["10", "Name it and Save", "Type 'Resume Reviewer' in the name field and click Save for future use."],
                  ].map(([num, title, desc]) => (
                    <div key={num} className="flex gap-3 bg-slate-900/50 rounded-lg p-3">
                      <span className="w-7 h-7 rounded-full bg-indigo-600 text-white flex items-center justify-center text-xs font-bold flex-shrink-0 mt-0.5">{num}</span>
                      <div>
                        <p className="text-white font-semibold">{title}</p>
                        <p className="text-slate-400 text-sm mt-0.5">{desc}</p>
                      </div>
                    </div>
                  ))}
                </div>
                <p className="text-emerald-400 font-medium mt-2">That's it! You just built a professional-grade prompt. Copy it, paste it into any AI, and see the difference structured prompting makes.</p>
              </div>
            </section>

            {/* Section 12 */}
            <section className="space-y-4">
              <div className="flex items-center gap-3">
                <span className="w-10 h-10 rounded-xl bg-indigo-600/20 text-indigo-400 flex items-center justify-center font-bold">12</span>
                <h3 className="text-xl font-bold text-white">Tips, Tricks & Common Mistakes</h3>
              </div>
              <div className="bg-slate-800/30 rounded-xl border border-slate-700/50 p-6 space-y-4 text-slate-300 text-[15px] leading-relaxed">
                <div className="space-y-3">
                  <div className="bg-emerald-950/20 border border-emerald-800/20 rounded-lg p-4">
                    <p className="text-emerald-400 font-semibold mb-1">DO: Start small</p>
                    <p>Begin with just role + mission + output_format. Add more tags only when you hit a specific problem. A prompt with 3 great tags beats 12 mediocre ones.</p>
                  </div>
                  <div className="bg-emerald-950/20 border border-emerald-800/20 rounded-lg p-4">
                    <p className="text-emerald-400 font-semibold mb-1">DO: Be specific</p>
                    <p>"Marketing expert" is vague. "Senior B2B SaaS growth marketer specializing in PLG conversion funnels" is precise. Specificity reduces AI guessing.</p>
                  </div>
                  <div className="bg-emerald-950/20 border border-emerald-800/20 rounded-lg p-4">
                    <p className="text-emerald-400 font-semibold mb-1">DO: Use examples</p>
                    <p>If you're not getting the right output, add one concrete example. It's the single most effective fix for almost any prompt problem.</p>
                  </div>
                  <div className="bg-emerald-950/20 border border-emerald-800/20 rounded-lg p-4">
                    <p className="text-emerald-400 font-semibold mb-1">DO: Remix templates</p>
                    <p>Load a template, change the role, adjust the mission, tweak the rules. Remixing a proven prompt is faster than building from scratch.</p>
                  </div>
                  <div className="bg-red-950/20 border border-red-800/20 rounded-lg p-4">
                    <p className="text-red-400 font-semibold mb-1">DON'T: Write "be helpful"</p>
                    <p>Every AI already tries to be helpful. That instruction adds zero information. Write rules that override specific defaults you don't want.</p>
                  </div>
                  <div className="bg-red-950/20 border border-red-800/20 rounded-lg p-4">
                    <p className="text-red-400 font-semibold mb-1">DON'T: Skip output_format</p>
                    <p>This is the #1 reason people get unexpected results. Always tell the AI what the output should look like â€” length, structure, sections, format.</p>
                  </div>
                  <div className="bg-red-950/20 border border-red-800/20 rounded-lg p-4">
                    <p className="text-red-400 font-semibold mb-1">DON'T: Copy prompts blindly</p>
                    <p>Someone else's prompt was built for their context, their use case, their output needs. Always remix it for yours. That's what this app is for.</p>
                  </div>
                </div>
              </div>
            </section>

            {/* CTA */}
            <div className="text-center py-8 border-t border-slate-800">
              <p className="text-slate-300 text-lg font-medium mb-2">Ready to build your first prompt?</p>
              <p className="text-slate-500 mb-6">Start with the Builder or load a Template to remix.</p>
              <div className="flex items-center justify-center gap-3">
                <button onClick={() => setActiveTab("builder")}
                  className="px-6 py-3 bg-indigo-600 hover:bg-indigo-500 text-white font-medium rounded-lg transition-colors">
                  Open Builder
                </button>
                <button onClick={() => setActiveTab("templates")}
                  className="px-6 py-3 bg-slate-700 hover:bg-slate-600 text-white font-medium rounded-lg transition-colors">
                  Browse Templates
                </button>
              </div>
            </div>
          </div>
        )}

      </main>

      <footer className="border-t border-slate-800 mt-16 py-6">
        <div className="max-w-7xl mx-auto px-6 text-center text-sm text-slate-600">
          Prompt Architect â€” Build prompts like you build systems. No more copy-pasting wishes.
        </div>
      </footer>
    </div>
  );
}


ReactDOM.createRoot(document.getElementById("root")).render(React.createElement(PromptArchitect));

  </script>
</body>
</html>